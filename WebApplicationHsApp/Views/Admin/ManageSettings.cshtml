@model WebApplicationHsApp.DataModel.tbl_Settings
@{
    ViewBag.Title = "ManageSettings";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<script src="~/ckeditor/ckeditor.js"></script>
<style>
    td {
        word-break: break-all;
    }
</style>
<div class="row">
    <div class="col-lg-12">
        <div class="panel panel-default">
            <div class="panel-heading">Manage Settings </div>
            <div class="panel-body">
                <div class="col-lg-12" style="padding:1%;border-top:1px solid #ccc">
                    <table id="tbllocation" class="table table-striped table-bordered dt-responsive nowrap" style="width:100%;">
                        <thead>
                            <tr>
                                <th>Key</th>
                                <th>Value</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

</div>
@using (Html.BeginForm("SaveSettings", "Admin", new { ReturnUrl = ViewBag.ReturnUrl }, FormMethod.Post, new { @class = "form-horizontal", role = "form" }))
{
<div class="col-lg-12" style="padding:2%;">
    <div class="col-xs-1">

        <label for="name">Key </label>
    </div>
    <div class="col-xs-3">
       @Html.TextBoxFor(m=>m.SettingKey)
    </div>


    <div class="col-xs-2">
        <input type="submit" name="name" value="Submit" class="btn btn-primary" />
        <input type="button" name="name" value="Cancel" class="btn btn-danger" onclick="clearAll()" />
    </div>
</div>
<div class="col-xs-12">
    <label for="name">Value </label>
    @Html.TextAreaFor(m => m.SettingValue)
</div>
}
<script>
    var validate = true;

    $(document).ready(function () {
        CKEDITOR.replace('SettingValue');
        LoadTable();
    });

    function SubmitForm() {

        $(".css-error").removeClass('css-error');
        validateform();
        if (validate) {
            var task = {
                SettingKey: $("#txtKey").val(),
                SettingsId: $("#hdnDepartmentId").val(),
                SettingValue: $("#txtValue").val()

            };
            $.ajax({
                type: "POST",
                url: "/Admin/SaveSettings",
                data: task,
                success: function (data) {
                    alert(data);
                    clearAll();
                },
                error: function () {
                    alert("error")
                }
            });
        }
        else {

            alert("Fields Required");
        }
    }
    function onDelete(id) {
        if (confirm('Are you sure you want to delete?')) {
            $.getJSON("@Url.Action("DeleteSettings", "Admin")", { id: id }, function (data) {
                clearAll();

            });
        } return false;
    }
    function clearAll() {
        $("#txtKey").val("");
        $("#hdnDepartmentId").val("");
        $("#txtValue").val("");
        LoadTable();
    }

    function onEdit(a, b, c) {
        clearAll();
        $("#txtKey").val(a);
        $("#hdnDepartmentId").val(b);
        $("#txtValue").val(c);
    }

    function validateform() {

        validate = true;
        $(".css-error").removeClass('css-error');
        if ($("#txtKey").val() == "") {
            $("#txtKey").addClass('css-error');
            validate = false;
        }
        if ($("#txtValue").val() == "") {
            $("#txtValue").addClass('css-error');
            validate = false;
        }
    }
    function LoadTable() {
        $('#tbllocation').dataTable({
            //  "bServerSide": true,
            "sAjaxSource": "@Url.Action("GetSettingsView", "Admin")",
            "bProcessing": true,
            "bDestroy": true,
            "aoColumns": [

                            { "sName": "SettingKey" },
                             { "sName": "SettingValue" },
                            {
                                "sName": "SettingsId",
                                "bSortable": false,
                                "render": function (data, row, r) {
                                    var lname = "'" + r[0] + "'";
                                    var vname = "'" + r[1] + "'";
                                    return '<div >' +
                           
                             '<div style="width: 80px; float: left;"><span class="icon-trash"></span><a href="javascript:void(0)" class="deleteLink" onclick="onDelete(' + data + ')">Delete</a></div></div>';
                                }
                            }

            ],
            "aLengthMenu": [[10, 20, 30, 50, 100, 150, 200, 500, 1000], [10, 20, 30, 50, 100, 150, 200, 500, 1000]],
            "sDom": 'T<"clear">lfrtip',
            "oTableTools": {
                "sSwfPath": "/swf/copy_csv_xls_pdf.swf",
                "aButtons": [
                    "copy", "xls", "pdf"
                ]
            }

        }); Applyclassdt();
    }
    function Applyclassdt() {
        $("#tbllocation_length").addClass("col-md-6");
        $("#tbllocation_info").addClass("col-md-6");

    }
</script>
