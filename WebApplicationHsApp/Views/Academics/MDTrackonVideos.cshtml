
@{
    ViewBag.Title = "MDTrackonVideos";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<script>
    $(document).ready(function () {
        LoadEmployeesWhohaveLogin();
        LoadData();
    });
    function LoadEmployeesWhohaveLogin() {
        $.get("/Account/GetUsersBasedonRole?role=VideoTraining", function (data) {
            console.log(data);
            var htmlbody = "";
            for (var i = 0; i < data.length; i++) {
                htmlbody += "<tr><td>" + data[i].CustomUserId + "</td><td>" + data[i].Name + "</td><td>" + data[i].LocationName + "</td><td>" + data[i].DepartmentName + "</td></tr>";
            }
            $("#employeeswhohaveaccess").html(htmlbody);
        });
    }


    function LoadData() {
        $('#employeeswhoviewedvideo').dataTable({
            "bServerSide": true,
            "sAjaxSource": "/Academics/AjaxUsersViewdHistory",
            "bProcessing": true,
            "bDestroy": true,
            "aLengthMenu": [[10, 20, 30, 50, 100, 150, 200, -1], [10, 20, 30, 50, 100, 150, 200, "All"]],
            "aoColumns": [
                { "sName": "DateOfViwed" },
                { "sName": "Name" },
                { "sName": "CategoryName" },
                { "sName": "UserId" },
                { "sName": "UserName" },
                { "sName": "TotalNoOfViews" }
            ]
        });
        $("#employeeswhoviewedvideo_length").addClass("col-md-6");
        $("#employeeswhoviewedvideo_length").addClass("col-md-6");
    }
    function ExporttoExcel() {
        window.location = "/Academics/ExportExcelVideoViews";
    }
</script>

<div class="panel panel-default">
    <div class="panel-heading">Users Who have Access?</div>
    <div class="panel-body">
        <table class="table table-bordered">
            <thead>
                <tr>
                    <td>User Id</td>
                    <td>Name</td>
                    <td>Location</td>
                    <td>Department</td>

                </tr>
            </thead>
            <tbody id="employeeswhohaveaccess"></tbody>
        </table>
    </div>
</div>

<div class="panel panel-default">
    <div class="panel-heading">Employees Video Viewed History <span class="pull-right" style="color:teal;cursor:pointer;font-weight:bold;" onclick="ExporttoExcel();">Export To Excel </span></div>
    <div class="panel-body">
        <table class="table table-striped table-bordered dt-responsive nowrap" id="employeeswhoviewedvideo">
            <thead>
                <tr>
                    <td>Date</td>
                    <td>Title</td>
                    <td>Category</td>
                    <td>User Id</td>
                    <td>User Name</td>
                    <td>No Of Views</td>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
    </div>
</div>
